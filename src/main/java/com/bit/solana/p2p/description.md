实现高效数据流转

高效节点发现


kademlia DHT协议

更合理的实现：“非对称密钥交换 + 对称加密”
实际通信中，更优的方案是结合非对称加密和对称加密，流程如下（类似 TLS/Noise 的简化版）：
1. 初始化阶段（密钥协商）
   A 和 B 各自生成临时非对称密钥对（用于本次会话，避免长期密钥泄露风险）。
   A 已知 B 的长期公钥（用于身份验证），A 将自己的临时公钥用 B 的长期公钥加密后发给 B（确保只有 B 能解密）。
   B 用自己的长期私钥解密，得到 A 的临时公钥；同时 B 生成自己的临时公钥，用 A 的临时公钥（非对称加密）发给 A。
2. 生成会话密钥（对称密钥）
   A 和 B 分别用自己的临时私钥 + 对方的临时公钥，通过ECDH（椭圆曲线密钥交换） 计算出相同的共享密钥。
   用 HKDF 等密钥派生算法，从共享密钥中生成会话密钥（对称密钥，如 AES 密钥）。
3. 数据传输阶段
   后续所有消息都用会话密钥进行对称加密（如 AES-GCM、ChaCha20-Poly1305），同时附加消息认证码（MAC）防止篡改。
   双向通信只需一套会话密钥，性能极高。

A B 是内网节点
X是公网节点
 A - X - B   
A和X连接 
X和B连接
此时A通过Kademlia 协议找到B
A连接B时 A知道B是内网节点


用netty的UDP实现可靠二进制数据传输
实现基于一个连接创建无限多个流,支持单向流和双向流,无队头阻塞,可靠传输,
序列号 ACK 确认 超时重传 滑动窗口 乱序缓存
连接内独立流ID，每个流维护独立的序列号 / 重传队列，流级故障不扩散
基于四元组（源 IP / 端口 + 目的 IP / 端口）生成连接 ID，心跳保活
扩展:线程安全 资源自动回收 超时策略 异常容错 MTU 适配 前向纠错 拥塞算法 对象池化 对 ByteBuf、ReliableUdpFrame 等高频对象池化，减少 GC
支持批量ACK 支持流级优先级，高优先级流优先占用发送窗口
支持监控指标暴露 RTT、丢包率、FEC 恢复率、拥塞窗口等监控指标
支持连接迁移客户端 IP / 端口变化时保持连接
支持创建流时可以设置 QPS 上限，避免恶意攻击默认无上限
支持使用 Netty 的 FileRegion 实现大文件传输的零拷贝
全部在应用层实现 不改动netty任何代码  不能简化任何算法和代码

quic层处理完后 将数据交付到一下一个处理器  也就是quic处理器处理完 交给下一层 处理器

首次连接 发送 本节点ID 