<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交易转账系统</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome图标 -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        success: '#52C41A',
                        danger: '#FF4D4F',
                        neutral: '#F5F7FA',
                        'neutral-dark': '#4E5969'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-shadow {
                box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
            }
            .input-focus {
                @apply focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-inter min-h-screen">
<!-- 顶部导航 -->
<header class="bg-white shadow-sm sticky top-0 z-10">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
        <div class="flex items-center space-x-2">
            <i class="fa fa-exchange text-primary text-2xl"></i>
            <h1 class="text-xl font-bold text-gray-800">交易转账系统</h1>
        </div>
        <div class="text-sm text-gray-500">
            <span id="currentTime"></span>
        </div>
    </div>
</header>

<!-- 主内容区 -->
<main class="container mx-auto px-4 py-8 md:py-12">
    <div class="max-w-3xl mx-auto">
        <!-- 卡片容器 -->
        <div class="bg-white rounded-xl p-6 md:p-8 card-shadow transition-all duration-300 hover:shadow-lg">
            <div class="text-center mb-8">
                <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-gray-800">发起转账交易</h2>
                <p class="text-gray-500 mt-2">请填写以下信息完成转账操作</p>
            </div>

            <!-- 转账表单 -->
            <form id="transferForm" class="space-y-6">
                <!-- 发送方信息 -->
                <div class="border-b border-gray-100 pb-6">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                        <i class="fa fa-user-circle text-primary mr-2"></i>发送方信息
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="privateKey" class="block text-sm font-medium text-gray-700 mb-1">私钥 (Hex格式)</label>
                            <div class="relative">
                                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                        <i class="fa fa-key"></i>
                                    </span>
                                <input type="text" id="privateKey" required
                                       class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                       placeholder="例如: 5f...">
                            </div>
                        </div>

                        <div>
                            <label for="fromAddress" class="block text-sm font-medium text-gray-700 mb-1">发送地址</label>
                            <div class="relative">
                                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                        <i class="fa fa-address-card"></i>
                                    </span>
                                <input type="text" id="fromAddress" required
                                       class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                       placeholder="Hex格式公钥">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 接收方信息 -->
                <div class="border-b border-gray-100 pb-6">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                        <i class="fa fa-user-plus text-primary mr-2"></i>接收方信息
                    </h3>

                    <div>
                        <label for="toAddress" class="block text-sm font-medium text-gray-700 mb-1">接收地址</label>
                        <div class="relative">
                                <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                    <i class="fa fa-map-marker"></i>
                                </span>
                            <input type="text" id="toAddress" required
                                   class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                   placeholder="Hex格式公钥或合约地址">
                        </div>
                    </div>
                </div>

                <!-- 交易信息 -->
                <div class="border-b border-gray-100 pb-6">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                        <i class="fa fa-exchange text-primary mr-2"></i>交易信息
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="amount" class="block text-sm font-medium text-gray-700 mb-1">转账金额</label>
                            <div class="relative">
                                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                        <i class="fa fa-money"></i>
                                    </span>
                                <input type="number" id="amount" required min="0" step="1"
                                       class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                       placeholder="请输入转账数量">
                            </div>
                        </div>

                        <div>
                            <label for="recentBlockhash" class="block text-sm font-medium text-gray-700 mb-1">最近区块哈希</label>
                            <div class="relative">
                                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500">
                                        <i class="fa fa-hashtag"></i>
                                    </span>
                                <input type="text" id="recentBlockhash" required
                                       class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                       placeholder="Hex格式">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 附加信息 -->
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-4 flex items-center">
                        <i class="fa fa-plus-circle text-primary mr-2"></i>附加信息 (可选)
                    </h3>

                    <div class="space-y-6">
                        <div>
                            <label for="instruction" class="block text-sm font-medium text-gray-700 mb-1">合约指令</label>
                            <input type="text" id="instruction"
                                   class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                   placeholder='例如: "transfer"'>
                        </div>

                        <div>
                            <label for="instructionData" class="block text-sm font-medium text-gray-700 mb-1">指令参数 (JSON字符串)</label>
                            <textarea id="instructionData" rows="3"
                                      class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                      placeholder='例如: {"owner":"..."}'></textarea>
                        </div>

                        <div>
                            <label for="relatedAccounts" class="block text-sm font-medium text-gray-700 mb-1">相关账户</label>
                            <input type="text" id="relatedAccounts"
                                   class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                   placeholder="Hex格式公钥列表，用逗号分隔">
                        </div>

                        <div>
                            <label for="signature" class="block text-sm font-medium text-gray-700 mb-1">签名 (Hex格式)</label>
                            <input type="text" id="signature"
                                   class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus transition-all"
                                   placeholder="可选">
                        </div>
                    </div>
                </div>

                <!-- 提交按钮 -->
                <div class="pt-4">
                    <button type="submit" id="submitBtn"
                            class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 flex items-center justify-center space-x-2">
                        <i class="fa fa-paper-plane"></i>
                        <span>提交交易</span>
                    </button>
                </div>
            </form>

            <!-- 响应结果区域 -->
            <div id="response" class="mt-8 p-4 rounded-lg hidden transition-all duration-300"></div>
        </div>
    </div>
</main>

<!-- 页脚 -->
<footer class="bg-white border-t border-gray-200 mt-12">
    <div class="container mx-auto px-4 py-6 text-center text-gray-500 text-sm">
        <p>© 2023 交易转账系统 - 安全高效的转账解决方案</p>
    </div>
</footer>

<script>
    // 显示当前时间
    function updateCurrentTime() {
        const now = new Date();
        document.getElementById('currentTime').textContent = now.toLocaleString('zh-CN', {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
    }
    updateCurrentTime();
    setInterval(updateCurrentTime, 1000);

    // 表单提交处理
    document.getElementById('transferForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const submitBtn = document.getElementById('submitBtn');
        const responseDiv = document.getElementById('response');

        // 禁用按钮防止重复提交
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fa fa-spinner fa-spin"></i><span>处理中...</span>';
        responseDiv.classList.add('hidden');

        // 构建TransferTx对象
        const transferTx = {
            privateKey: document.getElementById('privateKey').value,
            fromAddress: document.getElementById('fromAddress').value,
            toAddress: document.getElementById('toAddress').value,
            amount: BigInt(document.getElementById('amount').value),
            instruction: document.getElementById('instruction').value || null,
            instructionData: document.getElementById('instructionData').value || null,
            relatedAccounts: document.getElementById('relatedAccounts').value
                ? document.getElementById('relatedAccounts').value.split(',').map(acc => acc.trim())
                : null,
            recentBlockhash: document.getElementById('recentBlockhash').value,
            signature: document.getElementById('signature').value || null
        };

        // 发送POST请求到后端接口
        fetch('/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(transferTx)
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP错误状态: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                // 显示成功响应
                responseDiv.textContent = JSON.stringify(data, null, 2);
                responseDiv.classList.remove('hidden', 'bg-danger/10', 'border-danger', 'text-danger');
                responseDiv.classList.add('bg-success/10', 'border', 'border-success', 'text-success');

                // 滚动到响应区域
                responseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            })
            .catch(error => {
                // 显示错误信息
                responseDiv.textContent = `请求失败: ${error.message}`;
                responseDiv.classList.remove('hidden', 'bg-success/10', 'border-success', 'text-success');
                responseDiv.classList.add('bg-danger/10', 'border', 'border-danger', 'text-danger');
            })
            .finally(() => {
                // 恢复按钮状态
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fa fa-paper-plane"></i><span>提交交易</span>';
            });
    });
</script>
</body>
</html>